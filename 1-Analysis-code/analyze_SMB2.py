from config import ransomware_csv_dir, benign_csv_dir, result_dir
from utils import is_clean_domain
import pandas as pd
import matplotlib.pyplot as plt
from collections import defaultdict
import os
import json
from tqdm import tqdm


protocol_one_direction_id = [
    "161",
    "191",
    "2004",
    "1509",
    "2006",
    "1513",
    "1515",
    "581",
    "264",
    "592",
    "298",
    "1524",
    "654",
    "1073",
    "414",
    "666",
    "1540",
    "459",
    "1544",
    "475",
    "1547",
    "724",
    "4109",
    "1563",
    "2036",
    "1572",
    "798",
    "1147",
    "846",
    "1174",
    "877",
    "900",
    "922",
    "925",
    "1219",
    "949",
    "1224",
    "1228",
    "1246",
    "1247",
    "1278",
    "1319",
    "4117",
    "1382",
    "1391",
    "1697",
    "1699",
    "1401",
    "1712",
    "2113",
    "1450",
    "4120",
    "1747",
    "1768",
    "1769",
    "1781",
    "2156",
    "2741",
    "2171",
    "1834",
    "1835",
    "1966",
    "2775",
    "2226",
    "2230",
    "2956",
    "2233",
    "2792",
    "2793",
    "2965",
    "2970",
    "4141",
    "3020",
    "3025",
    "7900",
    "3032",
    "3056",
    "4440",
    "4452",
    "4455",
    "4457",
    "4465",
    "4472",
    "4493",
    "4298",
    "3316",
    "4517",
    "4353",
    "3486",
    "3497",
    "3508",
    "6298",
    "3574",
    "4707",
    "3658",
    "3678",
    "3680",
    "3681",
    "3688",
    "3706",
    "3718",
    "3724",
    "3736",
    "3747",
    "6550",
    "3799",
    "3816",
    "3851",
    "3866",
    "3885",
    "6390",
    "3925",
    "3936",
    "3976",
    "3979",
    "3980",
    "3984",
    "4001",
    "4888",
    "4034",
    "4036",
    "4042",
    "4067",
    "4103",
    "6604",
    "4989",
    "6610",
    "6615",
    "5021",
    "5029",
    "6495",
    "5056",
    "7916",
    "6645",
    "7044",
    "6889",
    "5165",
    "6774",
    "7074",
    "7080",
    "6970",
    "6979",
    "7095",
    "6989",
    "6995",
    "7001",
    "9127",
    "7961",
    "7127",
    "7132",
    "7135",
    "7181",
    "7196",
    "7210",
    "9160",
    "7252",
    "7320",
    "7360",
    "7367",
    "7373",
    "7387",
    "7390",
    "7403",
    "7414",
    "7444",
    "7456",
    "7500",
    "7527",
    "7530",
    "8170",
    "8175",
    "7590",
    "7592",
    "9252",
    "7623",
    "7694",
    "7710",
    "7742",
    "9299",
    "8341",
    "9323",
    "8378",
    "8414",
    "9379",
    "8469",
    "8491",
    "8553",
    "9438",
    "8580",
    "9442",
    "8609",
    "8638",
    "9529",
    "8795",
    "8824",
    "8825",
    "8835",
    "8955",
    "8963",
    "9663",
    "9031",
    "9673",
    "9073",
    "9688",
    "9743",
    "9778",
    "9847",
    "9925",
    "9980"
]

if __name__ == '__main__':
    for file in os.listdir(ransomware_csv_dir):
        sample_id = int(file.split('.')[0])
        df = pd.read_csv(f'{ransomware_csv_dir}/{file}', index_col=0)
        SMB2_count = 0
        for idx, row in df.iterrows():
            if row['protocol'] == 'SMB2':
                SMB2_count += 1

        if SMB2_count > 100:
            print("=======================")
            print(sample_id)
            print(SMB2_count)
            print("=======================\n")
            